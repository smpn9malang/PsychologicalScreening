<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PFA Counseling API Client</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- React & React DOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: var(--primary-color);
        }
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .navbar-brand {
            font-weight: 700;
            color: white !important;
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 30px;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            padding: 15px 20px;
        }
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .patient-card {
            border-left: 4px solid var(--secondary-color);
            margin-bottom: 15px;
        }
        .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        .btn-success {
            background-color: var(--success-color);
            border-color: var(--success-color);
        }
        .btn-success:hover {
            background-color: #27ae60;
            border-color: #27ae60;
        }
        .btn-danger {
            background-color: var(--danger-color);
            border-color: var(--danger-color);
        }
        .btn-danger:hover {
            background-color: #c0392b;
            border-color: #c0392b;
        }
        .loading-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            border: 0.25rem solid rgba(0, 0, 0, 0.1);
            border-right-color: var(--secondary-color);
            border-radius: 50%;
            animation: spinner 0.75s linear infinite;
        }
        @keyframes spinner {
            to {
                transform: rotate(360deg);
            }
        }
        .alert {
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .form-control {
            border-radius: 10px;
            padding: 10px 15px;
        }
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }
        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .modal-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0;
        }
        .modal-footer {
            border-top: none;
        }
        .badge {
            padding: 6px 10px;
            border-radius: 10px;
            font-weight: 600;
        }
        .tab-content {
            padding: 20px;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 10px 10px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // API Base URL
        const API_BASE_URL = 'http://localhost:8000/api/v1';

        // App Component
        function App() {
            const [view, setView] = useState('login');
            const [token, setToken] = useState('');
            const [isAdmin, setIsAdmin] = useState(false);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');

            const handleLogout = () => {
                setToken('');
                setIsAdmin(false);
                setView('login');
            };

            const handleLogin = (token, isAdmin) => {
                setToken(token);
                setIsAdmin(isAdmin);
                setView('patients');
            };

            // Clear messages after 5 seconds
            useEffect(() => {
                if (error || success) {
                    const timer = setTimeout(() => {
                        setError('');
                        setSuccess('');
                    }, 5000);
                    return () => clearTimeout(timer);
                }
            }, [error, success]);

            return (
                <>
                    <nav className="navbar navbar-expand-lg navbar-dark sticky-top mb-4">
                        <div className="container">
                            <a className="navbar-brand" href="#">
                                <i className="fas fa-brain me-2"></i>
                                PFA Counseling API Client
                            </a>
                            {token && (
                                <div className="ms-auto">
                                    <div className="d-flex">
                                        <div className="nav-item dropdown">
                                            <a className="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown">
                                                <i className="fas fa-user-circle me-1"></i> 
                                                {isAdmin ? 'Admin' : 'User'}
                                            </a>
                                            <ul className="dropdown-menu dropdown-menu-end">
                                                <li><a className="dropdown-item" href="#" onClick={() => handleLogout()}><i className="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </nav>

                    <div className="container">
                        {error && (
                            <div className="alert alert-danger" role="alert">
                                <i className="fas fa-exclamation-circle me-2"></i> {error}
                            </div>
                        )}
                        {success && (
                            <div className="alert alert-success" role="alert">
                                <i className="fas fa-check-circle me-2"></i> {success}
                            </div>
                        )}

                        {view === 'login' && (
                            <LoginForm 
                                onLogin={handleLogin} 
                                setLoading={setLoading} 
                                setError={setError}
                            />
                        )}

                        {token && view === 'patients' && (
                            <PatientList 
                                token={token} 
                                isAdmin={isAdmin} 
                                setLoading={setLoading}
                                setError={setError}
                                setSuccess={setSuccess}
                            />
                        )}

                        {loading && (
                            <div className="position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center" style={{ backgroundColor: 'rgba(0,0,0,0.5)', zIndex: 1050 }}>
                                <div className="bg-white p-5 rounded-3 d-flex flex-column align-items-center">
                                    <div className="loading-spinner mb-3"></div>
                                    <p className="mb-0">Loading...</p>
                                </div>
                            </div>
                        )}
                    </div>
                </>
            );
        }

        // Login Form Component
        function LoginForm({ onLogin, setLoading, setError }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!username || !password) {
                    setError('Please enter both username and password');
                    return;
                }

                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ username, password }),
                    });

                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(data.message || 'Authentication failed');
                    }

                    const token = data.data.token;
                    const isAdmin = data.data.user.is_admin;
                    
                    onLogin(token, isAdmin);
                } catch (error) {
                    setError(error.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="row justify-content-center">
                    <div className="col-md-6">
                        <div className="card">
                            <div className="card-header">
                                <h2><i className="fas fa-lock me-2"></i>Login</h2>
                            </div>
                            <div className="card-body">
                                <form onSubmit={handleSubmit}>
                                    <div className="mb-3">
                                        <label htmlFor="username" className="form-label">Username</label>
                                        <div className="input-group">
                                            <span className="input-group-text"><i className="fas fa-user"></i></span>
                                            <input 
                                                type="text" 
                                                className="form-control" 
                                                id="username" 
                                                value={username} 
                                                onChange={(e) => setUsername(e.target.value)} 
                                                placeholder="Enter username"
                                            />
                                        </div>
                                        <div className="form-text">Try using "admin" or "user"</div>
                                    </div>
                                    <div className="mb-4">
                                        <label htmlFor="password" className="form-label">Password</label>
                                        <div className="input-group">
                                            <span className="input-group-text"><i className="fas fa-key"></i></span>
                                            <input 
                                                type="password" 
                                                className="form-control" 
                                                id="password" 
                                                value={password} 
                                                onChange={(e) => setPassword(e.target.value)} 
                                                placeholder="Enter password"
                                            />
                                        </div>
                                        <div className="form-text">Try using "admin" or "user" as password</div>
                                    </div>
                                    <button type="submit" className="btn btn-primary w-100">
                                        <i className="fas fa-sign-in-alt me-2"></i>Login
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Patient List Component
        function PatientList({ token, isAdmin, setLoading, setError, setSuccess }) {
            const [patients, setPatients] = useState([]);
            const [selectedPatient, setSelectedPatient] = useState(null);
            const [showAddPatient, setShowAddPatient] = useState(false);
            const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
            const [pagination, setPagination] = useState({
                page: 1,
                per_page: 10,
                total_count: 0,
                total_pages: 0
            });
            const [searchQuery, setSearchQuery] = useState('');

            const fetchPatients = async () => {
                setLoading(true);
                try {
                    const query = new URLSearchParams({
                        page: pagination.page,
                        per_page: pagination.per_page
                    });
                    
                    if (searchQuery) {
                        query.append('search', searchQuery);
                    }
                    
                    const response = await fetch(`${API_BASE_URL}/patients?${query}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to fetch patients');
                    }
                    
                    const data = await response.json();
                    setPatients(data.data.patients || []);
                    setPagination(data.data.pagination || pagination);
                } catch (error) {
                    setError(error.message);
                } finally {
                    setLoading(false);
                }
            };

            useEffect(() => {
                fetchPatients();
            }, [token, pagination.page, searchQuery]);

            const handlePageChange = (newPage) => {
                setPagination({...pagination, page: newPage});
            };

            const handleSearch = (e) => {
                e.preventDefault();
                setPagination({...pagination, page: 1});
            };

            const handleDeletePatient = async () => {
                if (!selectedPatient) return;
                
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE_URL}/patients/${selectedPatient.id}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'Failed to delete patient');
                    }
                    
                    setSuccess(`Patient ${selectedPatient.name} deleted successfully`);
                    setShowDeleteConfirm(false);
                    fetchPatients();
                } catch (error) {
                    setError(error.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <>
                    <div className="card">
                        <div className="card-header d-flex justify-content-between align-items-center">
                            <h2><i className="fas fa-users me-2"></i>Patients</h2>
                            <button 
                                className="btn btn-success" 
                                onClick={() => setShowAddPatient(true)}
                            >
                                <i className="fas fa-plus me-2"></i>Add Patient
                            </button>
                        </div>
                        <div className="card-body">
                            <form onSubmit={handleSearch} className="mb-4">
                                <div className="input-group">
                                    <input 
                                        type="text" 
                                        className="form-control" 
                                        placeholder="Search patients..." 
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                    />
                                    <button className="btn btn-primary" type="submit">
                                        <i className="fas fa-search me-2"></i>Search
                                    </button>
                                </div>
                            </form>
                            
                            {patients.length === 0 ? (
                                <div className="alert alert-info">
                                    <i className="fas fa-info-circle me-2"></i> No patients found
                                </div>
                            ) : (
                                <>
                                    {patients.map(patient => (
                                        <div key={patient.id} className="card patient-card">
                                            <div className="card-body">
                                                <div className="d-flex justify-content-between align-items-center">
                                                    <div>
                                                        <h5 className="card-title">{patient.name}</h5>
                                                        <p className="card-text mb-1">
                                                            <span className="badge bg-info me-2">{patient.gender}</span>
                                                            <span className="badge bg-secondary">{patient.age} years</span>
                                                        </p>
                                                        <small className="text-muted">ID: {patient.id}</small>
                                                    </div>
                                                    <div className="d-flex">
                                                        <button 
                                                            className="btn btn-sm btn-primary me-2"
                                                            onClick={() => setSelectedPatient(patient)}
                                                        >
                                                            <i className="fas fa-eye me-1"></i> View
                                                        </button>
                                                        {isAdmin && (
                                                            <button 
                                                                className="btn btn-sm btn-danger"
                                                                onClick={() => {
                                                                    setSelectedPatient(patient);
                                                                    setShowDeleteConfirm(true);
                                                                }}
                                                            >
                                                                <i className="fas fa-trash me-1"></i> Delete
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    
                                    {pagination.total_pages > 1 && (
                                        <nav aria-label="Pagination" className="mt-4">
                                            <ul className="pagination justify-content-center">
                                                <li className={`page-item ${pagination.page === 1 ? 'disabled' : ''}`}>
                                                    <button 
                                                        className="page-link" 
                                                        onClick={() => handlePageChange(pagination.page - 1)}
                                                        disabled={pagination.page === 1}
                                                    >
                                                        <i className="fas fa-chevron-left"></i>
                                                    </button>
                                                </li>
                                                
                                                {Array.from({ length: pagination.total_pages }, (_, i) => (
                                                    <li key={i} className={`page-item ${pagination.page === i + 1 ? 'active' : ''}`}>
                                                        <button 
                                                            className="page-link" 
                                                            onClick={() => handlePageChange(i + 1)}
                                                        >
                                                            {i + 1}
                                                        </button>
                                                    </li>
                                                ))}
                                                
                                                <li className={`page-item ${pagination.page === pagination.total_pages ? 'disabled' : ''}`}>
                                                    <button 
                                                        className="page-link" 
                                                        onClick={() => handlePageChange(pagination.page + 1)}
                                                        disabled={pagination.page === pagination.total_pages}
                                                    >
                                                        <i className="fas fa-chevron-right"></i>
                                                    </button>
                                                </li>
                                            </ul>
                                        </nav>
                                    )}
                                </>
                            )}
                        </div>
                    </div>

                    {/* Add Patient Modal */}
                    {showAddPatient && (
                        <AddPatientModal 
                            token={token}
                            onClose={() => setShowAddPatient(false)}
                            onSuccess={() => {
                                setShowAddPatient(false);
                                setSuccess('Patient added successfully');
                                fetchPatients();
                            }}
                            setLoading={setLoading}
                            setError={setError}
                        />
                    )}

                    {/* View Patient Modal */}
                    {selectedPatient && !showDeleteConfirm && (
                        <PatientDetailsModal 
                            patient={selectedPatient}
                            onClose={() => setSelectedPatient(null)}
                        />
                    )}

                    {/* Delete Confirmation Modal */}
                    {showDeleteConfirm && (
                        <div className="modal d-block" tabIndex="-1" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>
                            <div className="modal-dialog">
                                <div className="modal-content">
                                    <div className="modal-header bg-danger text-white">
                                        <h5 className="modal-title">
                                            <i className="fas fa-exclamation-triangle me-2"></i>
                                            Confirm Delete
                                        </h5>
                                        <button type="button" className="btn-close btn-close-white" onClick={() => setShowDeleteConfirm(false)}></button>
                                    </div>
                                    <div className="modal-body">
                                        <p>Are you sure you want to delete patient <strong>{selectedPatient.name}</strong>?</p>
                                        <p className="text-danger"><small>This action cannot be undone.</small></p>
                                    </div>
                                    <div className="modal-footer">
                                        <button type="button" className="btn btn-secondary" onClick={() => setShowDeleteConfirm(false)}>
                                            <i className="fas fa-times me-2"></i>Cancel
                                        </button>
                                        <button type="button" className="btn btn-danger" onClick={handleDeletePatient}>
                                            <i className="fas fa-trash me-2"></i>Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        // Add Patient Modal Component
        function AddPatientModal({ token, onClose, onSuccess, setLoading, setError }) {
            const [formData, setFormData] = useState({
                name: '',
                age: '',
                gender: '',
                personal_data: {
                    address: '',
                    phone: '',
                    email: ''
                }
            });

            const handleChange = (e) => {
                const { name, value } = e.target;
                if (name.includes('.')) {
                    const [parent, child] = name.split('.');
                    setFormData(prev => ({
                        ...prev,
                        [parent]: {
                            ...prev[parent],
                            [child]: value
                        }
                    }));
                } else {
                    setFormData(prev => ({
                        ...prev,
                        [name]: value
                    }));
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!formData.name) {
                    setError('Patient name is required');
                    return;
                }

                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE_URL}/patients`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify(formData)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'Failed to add patient');
                    }

                    onSuccess();
                } catch (error) {
                    setError(error.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="modal d-block" tabIndex="-1" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>
                    <div className="modal-dialog modal-lg">
                        <div className="modal-content">
                            <div className="modal-header">
                                <h5 className="modal-title">
                                    <i className="fas fa-user-plus me-2"></i>
                                    Add New Patient
                                </h5>
                                <button type="button" className="btn-close btn-close-white" onClick={onClose}></button>
                            </div>
                            <div className="modal-body">
                                <form onSubmit={handleSubmit}>
                                    <div className="row mb-3">
                                        <div className="col-md-12">
                                            <label htmlFor="name" className="form-label">Full Name*</label>
                                            <input 
                                                type="text" 
                                                className="form-control" 
                                                id="name" 
                                                name="name"
                                                value={formData.name}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <label htmlFor="age" className="form-label">Age</label>
                                            <input 
                                                type="number" 
                                                className="form-control" 
                                                id="age" 
                                                name="age"
                                                value={formData.age}
                                                onChange={handleChange}
                                            />
                                        </div>
                                        <div className="col-md-6">
                                            <label htmlFor="gender" className="form-label">Gender</label>
                                            <select 
                                                className="form-select" 
                                                id="gender" 
                                                name="gender"
                                                value={formData.gender}
                                                onChange={handleChange}
                                            >
                                                <option value="">Select gender</option>
                                                <option value="Male">Male</option>
                                                <option value="Female">Female</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="mb-3">
                                        <label htmlFor="address" className="form-label">Address</label>
                                        <input 
                                            type="text" 
                                            className="form-control" 
                                            id="address" 
                                            name="personal_data.address"
                                            value={formData.personal_data.address}
                                            onChange={handleChange}
                                        />
                                    </div>
                                    <div className="row mb-3">
                                        <div className="col-md-6">
                                            <label htmlFor="phone" className="form-label">Phone</label>
                                            <input 
                                                type="text" 
                                                className="form-control" 
                                                id="phone" 
                                                name="personal_data.phone"
                                                value={formData.personal_data.phone}
                                                onChange={handleChange}
                                            />
                                        </div>
                                        <div className="col-md-6">
                                            <label htmlFor="email" className="form-label">Email</label>
                                            <input 
                                                type="email" 
                                                className="form-control" 
                                                id="email" 
                                                name="personal_data.email"
                                                value={formData.personal_data.email}
                                                onChange={handleChange}
                                            />
                                        </div>
                                    </div>
                                    <div className="modal-footer">
                                        <button type="button" className="btn btn-secondary" onClick={onClose}>
                                            <i className="fas fa-times me-2"></i>Cancel
                                        </button>
                                        <button type="submit" className="btn btn-primary">
                                            <i className="fas fa-save me-2"></i>Save Patient
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Patient Details Modal Component
        function PatientDetailsModal({ patient, onClose }) {
            return (
                <div className="modal d-block" tabIndex="-1" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>
                    <div className="modal-dialog modal-lg">
                        <div className="modal-content">
                            <div className="modal-header">
                                <h5 className="modal-title">
                                    <i className="fas fa-user me-2"></i>
                                    Patient Details
                                </h5>
                                <button type="button" className="btn-close btn-close-white" onClick={onClose}></button>
                            </div>
                            <div className="modal-body">
                                <div className="row mb-3">
                                    <div className="col-md-8">
                                        <h3>{patient.name}</h3>
                                        <p className="mb-1">
                                            <span className="badge bg-info me-2">{patient.gender || 'Not specified'}</span>
                                            <span className="badge bg-secondary">{patient.age ? `${patient.age} years` : 'Age not specified'}</span>
                                        </p>
                                        <p className="text-muted">Patient ID: {patient.id}</p>
                                    </div>
                                    <div className="col-md-4 text-md-end">
                                        <p className="mb-1"><small>Created: {new Date(patient.created_at).toLocaleString()}</small></p>
                                        {patient.updated_at && <p className="mb-0"><small>Updated: {new Date(patient.updated_at).toLocaleString()}</small></p>}
                                    </div>
                                </div>

                                <ul className="nav nav-tabs" role="tablist">
                                    <li className="nav-item" role="presentation">
                                        <button className="nav-link active" id="personal-tab" data-bs-toggle="tab" data-bs-target="#personal" type="button" role="tab">
                                            <i className="fas fa-address-card me-2"></i>Personal Information
                                        </button>
                                    </li>
                                    <li className="nav-item" role="presentation">
                                        <button className="nav-link" id="assessment-tab" data-bs-toggle="tab" data-bs-target="#assessment" type="button" role="tab">
                                            <i className="fas fa-clipboard-check me-2"></i>Assessment
                                        </button>
                                    </li>
                                    <li className="nav-item" role="presentation">
                                        <button className="nav-link" id="screening-tab" data-bs-toggle="tab" data-bs-target="#screening" type="button" role="tab">
                                            <i className="fas fa-notes-medical me-2"></i>Screening Data
                                        </button>
                                    </li>
                                </ul>
                                <div className="tab-content">
                                    <div className="tab-pane fade show active" id="personal" role="tabpanel">
                                        {patient.personal_data && Object.keys(patient.personal_data).length > 0 ? (
                                            <div className="row">
                                                <div className="col-md-6">
                                                    <p><strong>Address:</strong> {patient.personal_data.address || 'Not specified'}</p>
                                                    <p><strong>Phone:</strong> {patient.personal_data.phone || 'Not specified'}</p>
                                                </div>
                                                <div className="col-md-6">
                                                    <p><strong>Email:</strong> {patient.personal_data.email || 'Not specified'}</p>
                                                </div>
                                            </div>
                                        ) : (
                                            <p className="text-muted">No personal data available.</p>
                                        )}
                                    </div>
                                    <div className="tab-pane fade" id="assessment" role="tabpanel">
                                        {patient.assessment_data && Object.keys(patient.assessment_data).length > 0 ? (
                                            <div>
                                                <p><strong>Observations:</strong> {patient.assessment_data.observations || 'None'}</p>
                                                {/* Add more assessment data fields as needed */}
                                            </div>
                                        ) : (
                                            <p className="text-muted">No assessment data available.</p>
                                        )}
                                    </div>
                                    <div className="tab-pane fade" id="screening" role="tabpanel">
                                        {patient.screening_data && Object.keys(patient.screening_data).length > 0 ? (
                                            <div>
                                                {/* Display screening data based on what's available */}
                                                {patient.screening_data.srq_score !== undefined && (
                                                    <div className="mb-3">
                                                        <h5>SRQ Screening:</h5>
                                                        <p><strong>Score:</strong> {patient.screening_data.srq_score}</p>
                                                        <p><strong>Interpretation:</strong> {patient.screening_data.srq_interpretation || 'Not available'}</p>
                                                    </div>
                                                )}
                                                
                                                {patient.screening_data.dass_scores && (
                                                    <div>
                                                        <h5>DASS-42 Screening:</h5>
                                                        <p><strong>Depression:</strong> {patient.screening_data.dass_scores.depression} ({patient.screening_data.dass_interpretations?.depression || 'Not available'})</p>
                                                        <p><strong>Anxiety:</strong> {patient.screening_data.dass_scores.anxiety} ({patient.screening_data.dass_interpretations?.anxiety || 'Not available'})</p>
                                                        <p><strong>Stress:</strong> {patient.screening_data.dass_scores.stress} ({patient.screening_data.dass_interpretations?.stress || 'Not available'})</p>
                                                    </div>
                                                )}
                                            </div>
                                        ) : (
                                            <p className="text-muted">No screening data available.</p>
                                        )}
                                    </div>
                                </div>
                            </div>
                            <div className="modal-footer">
                                <button type="button" className="btn btn-secondary" onClick={onClose}>
                                    <i className="fas fa-times me-2"></i>Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the App component
        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);
    </script>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>